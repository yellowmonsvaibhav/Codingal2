<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>InkAura · Signature Studio</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#111">

<style>
:root{
--bg:#0f0f12;
--card:#18181d;
--accent:#6ae3ff;
--text:#fff;
}
*{margin:0;padding:0;box-sizing:border-box}
body{
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
background:var(--bg);
color:var(--text);
min-height:100vh;
display:flex;
flex-direction:column;
align-items:center;
padding:20px;
}
h1{
margin-bottom:20px;
font-weight:600;
letter-spacing:.5px;
}
.container{
display:flex;
gap:20px;
background:var(--card);
padding:20px;
border-radius:16px;
box-shadow:0 20px 60px rgba(0,0,0,.6);
}
canvas{
background:transparent;
border-radius:10px;
}
.controls{
width:220px;
display:flex;
flex-direction:column;
gap:12px;
}
button,input{
width:100%;
padding:10px;
border-radius:12px;
border:none;
font-size:14px;
}
button{
background:#222;
color:white;
cursor:pointer;
transition:.2s;
}
button:hover{background:#333}
button.active{background:var(--accent);color:#000}
input[type=color]{padding:4px;height:40px}
.slider label{font-size:12px;opacity:.7}
#preview{display:none;margin-top:10px}
</style>
</head>

<body>

<h1>InkAura · Signature Studio</h1>

<div class="container">
  <canvas id="canvas" width="500" height="300"></canvas>

  <div class="controls">
    <button class="effect active" onclick="setEffect('neon')">Anime Neon</button>
    <button class="effect" onclick="setEffect('brush')">Brush</button>
    <button class="effect" onclick="setEffect('sparkle')">Sparkle</button>

    <input type="color" id="color" value="#6ae3ff">

    <div class="slider">
      <label>Tilt</label>
      <input type="range" min="-45" max="45" value="0" oninput="tilt=this.value;updatePreview()">
    </div>

    <div class="slider">
      <label>Squash</label>
      <input type="range" min="0.5" max="2" step="0.1" value="1" oninput="squash=this.value;updatePreview()">
    </div>

    <button onclick="clearCanvas()">Clear</button>
    <button onclick="downloadPNG()">Download PNG</button>

    <canvas id="preview" width="250" height="150"></canvas>
  </div>
</div>

<script>
if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js')}

const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const preview=document.getElementById("preview");
const pctx=preview.getContext("2d");

let drawing=false;
let effect="neon";
let color=document.getElementById("color").value;
let tilt=0,squash=1;
let points=[];

ctx.lineCap="round";
ctx.lineJoin="round";

canvas.onmousedown=e=>{drawing=true;points=[[e.offsetX,e.offsetY]]};
canvas.onmousemove=e=>{
if(!drawing)return;
points.push([e.offsetX,e.offsetY]);
drawSmooth();
updatePreview();
};
canvas.onmouseup=()=>drawing=false;

document.getElementById("color").oninput=e=>color=e.target.value;

function drawSmooth(){
if(points.length<3)return;
const p0=points[points.length-3];
const p1=points[points.length-2];
const p2=points[points.length-1];
ctx.beginPath();
ctx.moveTo(p0[0],p0[1]);
ctx.quadraticCurveTo(p1[0],p1[1],p2[0],p2[1]);

ctx.strokeStyle=color;
ctx.lineWidth=effect==="brush"?6:4;
ctx.shadowBlur=effect==="neon"?25:0;
ctx.shadowColor=color;
ctx.stroke();
ctx.shadowBlur=0;
}

function setEffect(e){
effect=e;
document.querySelectorAll(".effect").forEach(b=>b.classList.remove("active"));
event.target.classList.add("active");
}

function updatePreview(){
preview.style.display="block";
pctx.clearRect(0,0,preview.width,preview.height);
pctx.save();
pctx.translate(preview.width/2,preview.height/2);
pctx.rotate(tilt*Math.PI/180);
pctx.scale(squash,1);
pctx.translate(-preview.width/2,-preview.height/2);
pctx.drawImage(canvas,0,0,preview.width,preview.height);
pctx.restore();
}

function clearCanvas(){
ctx.clearRect(0,0,canvas.width,canvas.height);
points=[];
preview.style.display="none";
}

function downloadPNG(){
const ex=document.createElement("canvas");
ex.width=canvas.width;
ex.height=canvas.height;
const ectx=ex.getContext("2d");
ectx.save();
ectx.translate(ex.width/2,ex.height/2);
ectx.rotate(tilt*Math.PI/180);
ectx.scale(squash,1);
ectx.translate(-ex.width/2,-ex.height/2);
ectx.drawImage(canvas,0,0);
ectx.restore();
const a=document.createElement("a");
a.download="inkaura-signature.png";
a.href=ex.toDataURL("image/png");
a.click();
}
</script>

</body>
  </html>
